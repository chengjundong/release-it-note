# 系统设计目的
* 设计为production环境，为真实世界服务的系统
* 不要设计为了通过QA测试的系统

# 开始设计
* 考虑开发成本
* 考虑下游系统的影响
* 避免“一次开发，终身维护”的项目设计
* 最初的设计决定，也是最后，最难以修改的决定
* 系统设计的初稿，是选team
* 越是对整体系统缺乏概念的team，越容易做出最无法修改的决定

# “象牙塔”架构师与实干派架构师
## “象牙塔”架构师
* 更关注系统的顶层抽象
* 关于实现，全部参考“公司标准”
* 程序员们也乐在其中，因为他们总是在用最衬手的武器
* 不用操心程序员如何工作；同样，也不用操心用户
* 设计一旦落石，基本都不可改。每个组件都stick to their role
## 实干派架构师
* 更关注细节，诸如CPU，内存，网络带宽需求
* 除了功能设计，会关心如何部署，需要收集哪些指标
* 明白系统是需要持续演进的，并且设计之初并保留了这种可能
* 熟知哪些组件在什么情况下需要扩展，需要替换。如，访问量激增等。

# 稳定性 Stability
## 故障恢复
* 遇到production故障，第一要务是重启服务
* 重启方法1：重启所有服务。就像医生对于一个发烧的病人尝试所有已知的治疗发烧病因的方法，但是由于发烧的病因太多，这个很耽误时间。
* 重启方法2：通过线索排查，精准定位到有问题的服务。这需要提前准备并测试，日志和分析报告，以及经验。
## 事后分析
* 一般从最后一次change开始着手
* 通常，处理一个事故后大家的看法，同处理事故本身一样重要
## 测试
* 一个可以复现bug的测试，应该作为bug fix的指标
## Cynical Software
* Don't trust anyone, even itself
* Expect bad things to happen and never suprise
* Won't keep "intimate" relationship with other system
## 术语
### transaction
有别于数据库事务，这里的transcation是指对于系统来说，一个最小的工作单元（unit of work）。举例，对于电子商务系统，一个transcation就是用户购买一个商品并完成支付。整个过程可能涉及多个系统，甚至是外部系统。
### impulse
脉冲，来自机械工程的词汇。特指对于系统的瞬时冲击，比如一条庆祝网站生日的tweet，会带来一波很高的瞬时流量。这就是一次冲击。
### stress
压力，同样来自机械工程的词汇。指对于系统，长时间的影响。比如一段时间内，来自银行系统的反馈速度很慢，会导致支付环节有很大的压力。
### 不出错时间
系统应该在很长一段时间内，一直可以处理transaction。如何定义很长一段时间呢？通用标准是code deployment的间隔。举例来说，如果一个系统1周部署一次，就不需要考虑是否可以持续运行2年不重启。
